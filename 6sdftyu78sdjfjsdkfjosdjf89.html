<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Baccarat Trend Predictor - VIP</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
    background-color: #2c2c2c;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #f0f0f0;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding: 10px;
    overflow: hidden;
}
.container {
    width: 550px;
    background-color: #3a3a3a;
    border-radius: 30px;
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    min-height: 50vh;
}
.logo { text-align: center; margin-bottom: 15px; display:flex; justify-content:center; align-items:center; gap:8px; }
.logo .logo-text { font-size: 22px; font-weight: bold; color: #ffffff; }
.logo .logo-icon { font-size: 22px; color: #32cd32; }

.buttons {
    display: flex;
    justify-content: space-between;
    gap: 10px;
    margin-bottom: 15px;
    flex-wrap: wrap;
}
.button {
    flex: 1 1 calc(25% - 10px);
    padding: 15px 0;
    font-size: 16px;
    color: #fff;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    font-weight: bold;
}
.button-P { background: linear-gradient(135deg, #00c6ff, #0072ff); }
.button-B { background: linear-gradient(135deg, #ff416c, #ff4b2b); }
.button-undo { background: linear-gradient(135deg, #757f9a, #d7dde8); color: #000; }
.button-reset { background: linear-gradient(135deg, #f7971e, #ffd200); color: #000; }

.input-display {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-bottom: 15px;
    max-height: 90px;
    overflow-y: auto;
    background-color: #555;
    border: 1px solid #777;
    border-radius: 6px;
    padding: 8px;
}
.input-char {
    padding: 6px 5px;
    border-radius: 4px;
    font-size: 20px;
    width: 26px;
    text-align: center;
    color: #fff;
    font-weight: bold;
}
.input-P { background-color: #00c6ff; }
.input-B { background-color: #ff416c; }

.progress-bar-container {
    background-color: #555;
    border-radius: 5px;
    overflow: hidden;
    height: 16px;
    margin-bottom: 15px;
    border: 1px solid #777;
}
.progress-bar {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg, #00c6ff, #32cd32);
    text-align: center;
    color: #fff;
    line-height: 16px;
    font-weight: bold;
    transition: width 0.5s;
}

.section-title {
    font-size: 18px;
    font-weight: bold;
    margin: 15px 0 8px;
    text-align: center;
    color: #32cd32;
}

.future-results {
    background-color: #444;
    padding: 12px;
    border-radius: 8px;
    margin-top: 8px;
    font-size: 14px;
}
.stacked-bar-bg {
    width: 100%;
    background-color: #555;
    border-radius: 8px;
    overflow: hidden;
    height: 24px;
    display: flex;
    margin-bottom: 8px;
}
.stacked-bar {
    height: 100%;
    text-align: center;
    line-height: 24px;
    font-weight: bold;
    color: #fff;
    transition: width 0.5s;
}
.player-bar { background: #0072ff; }
.banker-bar { background: #ff4b2b; }

.trend-labels {
    display: flex;
    justify-content: space-between;
    font-weight: bold;
    color: #fff;
    font-size: 15px;
}

.history-box {
    margin-top: 15px;
    padding: 8px;
    background-color: #444;
    border-radius: 8px;
    font-size: 25px;
    font-weight: bold;
    letter-spacing: 4px;
    text-align: center;
}
.history-win { color: #32cd32; }
.history-lose { color: #ff4b4b; }
</style>
</head>
<body>

<div class="container" id="appContainer" style="display:none;">

<div class="logo">
    <i class="fa-solid fa-chart-line logo-icon"></i>
    <span class="logo-text">AI Baccarat Trend Predictor</span>
</div>

<nav class="buttons">
    <button class="button button-P" onclick="addInput('P')">Player</button>
    <button class="button button-B" onclick="addInput('B')">Banker</button>
    <button class="button button-undo" onclick="undo()">UNDO</button>
    <button class="button button-reset" onclick="resetAll()">RESET</button>
</nav>

<div id="inputDisplay" class="input-display"></div>

<div id="progressContainer" class="progress-bar-container">
    <div id="progressBar" class="progress-bar">0%</div>
</div>

<div id="futureContainer" style="display:none;">
    <div class="section-title">Future Trends of Gaming Tables</div>
    <div class="future-results">
        <div class="stacked-bar-bg">
            <div id="playerTrendBar" class="stacked-bar player-bar" style="width:0%">0%</div>
            <div id="bankerTrendBar" class="stacked-bar banker-bar" style="width:0%">0%</div>
        </div>
        <div class="trend-labels">
            <span>PLAYER</span>
            <span>BANKER</span>
        </div>
    </div>
</div>

<div id="historyBox" class="history-box"></div>
</div>

<script>
// =================== SECURE SESSION CHECK ===================
(function(){
    const APP_KEY = "6sdftyu78sdjfjsdkfjosdjf89";

    const loggedIn   = localStorage.getItem("loggedIn");
    const allowedApp = localStorage.getItem("allowedApp");
    const expiresAt  = parseInt(localStorage.getItem("expiresAt"), 10);
    const now = Date.now();

    if (
        loggedIn !== "true" ||
        allowedApp !== 6sdftyu78sdjfjsdkfjosdjf89 ||
        !expiresAt ||
        expiresAt < now
    ) {
        localStorage.clear();
        window.location.replace("index.html");
        return;
    }

    document.addEventListener("DOMContentLoaded", function(){
        document.getElementById("appContainer").style.display = "flex";
    });
})();

// =================== APP LOGIC ===================
let inputs = [];
let trendsHistory = [];
let historyWL = [];
let lastPrediction = null;
let appHistory = [];

function saveSnapshot() {
    appHistory.push({
        inputs: [...inputs],
        trendsHistory: trendsHistory.map(t => ({...t})),
        historyWL: [...historyWL],
        lastPrediction
    });
}

function renderDisplay() {
    const display = document.getElementById("inputDisplay");
    display.innerHTML = "";
    inputs.slice(-10).forEach(c => {
        const div = document.createElement("div");
        div.classList.add("input-char", c === "P" ? "input-P" : "input-B");
        div.textContent = c;
        display.appendChild(div);
    });
    updateFutureTrends();
    updateHistory();
}

function addInput(v) {
    if(lastPrediction !== null) {
        historyWL.push(lastPrediction === v ? "W" : "L");
        lastPrediction = null;
    }

    inputs.push(v);

    let playerPercent = Math.floor(Math.random() * 61) + 20;
    let bankerPercent = 100 - playerPercent;

    trendsHistory.push({player: playerPercent, banker: bankerPercent});
    lastPrediction = playerPercent > bankerPercent ? "P" : "B";

    saveSnapshot();
    renderDisplay();
}

function undo() {
    if(appHistory.length < 2) return;
    appHistory.pop();
    const snapshot = appHistory[appHistory.length - 1];
    inputs = [...snapshot.inputs];
    trendsHistory = snapshot.trendsHistory.map(t => ({...t}));
    historyWL = [...snapshot.historyWL];
    lastPrediction = snapshot.lastPrediction;
    renderDisplay();
}

function resetAll() {
    inputs = [];
    trendsHistory = [];
    historyWL = [];
    lastPrediction = null;
    appHistory = [];
    renderDisplay();
}

function updateFutureTrends() {
    if(trendsHistory.length === 0) return;
    const trend = trendsHistory[trendsHistory.length-1];
    document.getElementById("futureContainer").style.display = "block";
    document.getElementById("playerTrendBar").style.width = trend.player + "%";
    document.getElementById("playerTrendBar").innerText = trend.player + "%";
    document.getElementById("bankerTrendBar").style.width = trend.banker + "%";
    document.getElementById("bankerTrendBar").innerText = trend.banker + "%";
}

function updateHistory() {
    const box = document.getElementById("historyBox");
    box.innerHTML = "";
    historyWL.slice(-10).forEach(r => {
        const span = document.createElement("span");
        span.textContent = r + " ";
        span.classList.add(r === "W" ? "history-win" : "history-lose");
        box.appendChild(span);
    });
}
</script>

</body>
</html>
